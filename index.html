<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Better Callbacks with Deferred Object</title>

		<meta name="description" content="Introduction and examples of deferred object. ">
		<meta name="author" content="Patrick Berkeley">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/beige.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', use the PDF print sheet -->
		<script>
			document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">

				<section>
					<h1>Deferred Object</h1>
					<h3>Ground rules and Use Cases</h3>
				</section>

				<section>
          <section>
            <h1>Ground Rules</h1>
          </section>
          <section>
            <h2>An object full of function</h2>
            <pre><code>
  $.Deferred = {
    always: function() {},
    done: function() {},
    fail: function() {},
    notify: function() {},
    notifyWith: function() {},
    pipe: function() {},
    progress: function() {},
    promise: function() {},
    reject: function() {},
    rejectWith: function() {},
    resolve: function() {},
    resolveWith: function() {},
    state: function() {},
    then: function() {},
  }
            </code></pre>
          </section>
          <section>
            <h2>promise()</h2>
            <pre><code>
  // A read-only version of the deferred object;
  // returned from a jQuery $.ajax() call.
  var deferred = $.Deferred();
  var promise = deferred.promise();
  Object.keys(promise);
  > ["state", "always", "then", "promise", "pipe", "done", "fail", "progress"]
            </code></pre>
          </section>
          <section>
            <h2>resolve()</h2>
            <pre><code>
  var deferred = $.Deferred();
  deferred.state();
  > "pending"

  deferred.resolve();
  deferred.state();
  > "resolved"
            </code></pre>
          </section>
          <section>
            <h2>reject()</h2>
            <pre><code>
  var deferred = $.Deferred();
  deferred.state();
  > "pending"

  deferred.reject();
  deferred.state();
  > "rejected"
            </code></pre>
          </section>
          <section>
            <h2>done()</h2>
            <pre><code>
  var deferred = $.Deferred();
  deferred.resolve();

  deferred.done(function() {
    console.log("I get called when things go well.");
  });
            </code></pre>
          </section>
          <section>
            <h2>fail()</h2>
            <pre><code>
  var deferred = $.Deferred();
  deferred.reject();

  deferred.fail(function() {
    console.log("I get called when things fall apart.");
  });
            </code></pre>
          </section>
          <section>
            <h2>always()</h2>
            <pre><code>
  var deferred = $.Deferred();
  deferred.resolve();

  deferred.always(function() {
    console.log("I'm so popular, I get called no matter what.");
  });
            </code></pre>
          </section>
          <section>
            <h2>then()</h2>
            <pre><code>
  var deferred = $.Deferred();
  // Shorthand for done, fail, and always.
  deferred.then(
    function(resp) {
      console.log("I'm a done callback!", resp);
    },
    function(resp) {
      console.log("I'm a fail callback.", resp);
    },
    function(resp) {
      console.log("I'm an always callback.", resp);
    }
  );
            </code></pre>
          </section>
          <section>
            <h2>pipe()</h2>
            <pre><code>
  var deferred = $.Deferred();
  deferred.pipe(
    function(resp) {
      console.log("I filter done responses", resp);
    },
    function(resp) {
      console.log("I filter fail responses", resp);
    },
    function(resp) {
      console.log("I filter progress responses", resp);
    }
  );
            </code></pre>
          </section>
				</section>

				<section>
          <section>
            <h1>Use Cases</h1>
          </section>
          <section>
            <h2>Requisite requests</h2>
            <pre><code>
  $.when($.get('api1/data'), $.get('api2/data'), { key: 'value' })
    .then(
      function(resp1, resp2, resp3) {
        // Do this if all requests succeed.
      },
      function(resp1, resp2, resp3) {
        // Do this if any request fails.
      },
      function(resp1, resp2, resp3) {
        // Do this after all requests succeed or one fails.
      }
    );
            </code></pre>
          </section>
          <section>
            <h2>Decoupled callbacks</h2>
            <pre><code>
  var req = $.ajax('api/data')
    .done(function(data) {
      // Do something in the same location the request was made.
    });

  req.done(function(data) {
    // Do something somewhere entirely different.
  });
            </code></pre>
          </section>
          <section>
            <h2>Filtered responses</h2>
            <pre><code>
  var getArticleByHeadline = function(query) {
    return $.ajax({ url: 'api/articles' })
      .pipe(function(data) {
        // Filter article headlines by query.
      });
  }

  getArticleByHeadline('wins election').done(function(articles) {
    // Do with the articles.
  });
            </code></pre>
          </section>
        </section>

				<section>
          <section>
            <h2>Summary</h2>
            <ul>
              <li class='fragment'>Really good when you need to guarantee something else has completed before proceeding.</li>
              <li class='fragment'>Good for decoupling your code.
            </ul>
          </section>
				</section>
			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,

				theme: 'beige', // available themes are in /css/theme
				transition: 'linear', // default/cube/page/concave/zoom/linear/none

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/highlight.js', async: true, callback: function() { window.hljs.initHighlightingOnLoad(); } },
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'lib/js/showdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'lib/js/data-markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'lib/js/jquery-1.8.2.js' },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});
		</script>

	</body>
</html>
